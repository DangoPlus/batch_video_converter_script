# AMD AMF 视频批量转码脚本 - 使用说明 (README)

## 脚本简介
这是一个功能强大的 Windows 批处理脚本，旨在自动化视频转码流程。它利用 FFmpeg 和您的 AMD 显卡（通过 AMF 硬件加速）来高效地将大量视频文件转换为高质量、小体积的 H.265 (HEVC) 编码格式。

## 核心功能
*   **AMD 硬件加速**: 使用 `hevc_amf` 编码器，充分利用您的 AMD 显卡性能，大幅提升转码速度。
*   **断点续传**: 自动记录已成功转换的文件。如果脚本中途停止，下次运行时会自动从上次中断的地方继续，不会重复工作。
*   **智能文件管理**: 成功转换后，原始文件会自动移动到备份文件夹，方便您检查后统一删除。
*   **完整流保留**:
    *   **字幕**: 完美复制所有内嵌的字幕轨道，无任何丢失。
    *   **多音轨**: 完美复制所有音频轨道。
*   **高度可配置**: 无需修改核心代码，只需在脚本顶部的配置区即可轻松调整所有重要参数。
*   **灵活的参数选项**:
    *   **分辨率**: 可选择保持原始分辨率，或缩放到指定分辨率（如 1080p），并能自动保持正确的宽高比。
    *   **音频**: 可选择无损复制原始音轨，或将其重新编码为兼容性强、体积小的 AAC 格式。
    *   **质量**: 提供 `速度`、`均衡`、`质量` 三种预设，满足不同需求。

## 首次使用设置 (只需一次)

在使用脚本前，您必须正确安装和配置 **FFmpeg**。

#### **步骤 1: 下载 FFmpeg**
1.  前往 FFmpeg 的官方 Windows 构建页面: [https://www.gyan.dev/ffmpeg/builds/](https://www.gyan.dev/ffmpeg/builds/)
2.  找到最新的 "release builds" 部分，下载名为 `ffmpeg-release-full.7z` 的文件。

#### **步骤 2: 解压并配置环境变量**
1.  将下载的 `.7z` 文件解压到一个**固定不动的位置**。例如，`C:\ffmpeg`。
2.  解压后，您会得到一个类似 `ffmpeg-7.0-full_build` 的文件夹，进入它，找到 `bin` 文件夹。此文件夹的完整路径就是我们需要的，例如: `C:\ffmpeg\ffmpeg-7.0-full_build\bin`。
3.  **将此 `bin` 文件夹路径添加到 Windows 的环境变量中**:
    *   右键点击 “此电脑” -> “属性”。
    *   点击 “高级系统设置” -> “环境变量”。
    *   在 “系统变量” 框中，找到并双击 `Path` 变量。
    *   在弹出的窗口中，点击 “新建”，然后将您刚才复制的 `bin` 文件夹完整路径粘贴进去。
    *   一路点击“确定”保存所有设置。

#### **步骤 3: 验证安装**
1.  按 `Win + R`，输入 `cmd` 并回车，打开一个新的命令提示符窗口。
2.  输入 `ffmpeg -version` 并按回车。
3.  如果您看到一长串关于 FFmpeg 版本和库的信息，说明安装配置成功！如果提示“不是内部或外部命令”，请重新检查环境变量的路径是否正确。

## 如何使用

#### **步骤 1: 保存并放置脚本**
将 `AMD_Transcode_Script.bat` 文件保存在一个您方便访问的位置，例如 `D:\Scripts`。

#### **步骤 2: 修改配置**
用记事本或任何文本编辑器打开 `AMD_Transcode_Script.bat` 文件。找到顶部的 **`用户配置区域`**，根据您的需求修改以下选项：

*   `sourceFolder`: 您存放待转换视频的文件夹路径。
*   `outputFolder`: 您希望保存转码后视频的文件夹路径。
*   `originalsFolder`: 转码成功的原始文件将被移动到此路径下。
*   `qualityPreset`: 质量预设。`balanced` 是一个很好的起点。
*   `outputResolution`:
    *   **保持原始分辨率**: `SET "outputResolution="` (将冒号后面的内容删掉)。
    *   **缩放为1080p (推荐)**: `SET "outputResolution=-1:1080"`。
*   `audioCommand`:
    *   **无损复制音频 (默认)**: 确保 `SET "audioCommand=-c:a copy"` 这一行前面**没有** `rem`。
    *   **压缩为AAC**: 在 `SET "audioCommand=-c:a copy"` 前面加上 `rem `，并**删除** `rem SET "audioCommand=-c:a aac -b:a 192k"` 前面的 `rem `。

**重要**: 文件夹路径不要以 `\` 结尾。

#### **步骤 3: 运行脚本**
1.  将您要转换的视频文件或文件夹放入您设置的 `sourceFolder` 中。
2.  双击运行 `AMD_Transcode_Script.bat`。
3.  一个命令提示符窗口将会出现，并开始自动处理文件。您可以随时关闭窗口来暂停任务。

## 工作流程详解
*   **日志文件**: 脚本运行时，会在其所在目录下创建一个 `completed_list.log` 文件。这个文件记录了所有已成功处理的源文件的完整路径。这是实现“断点续传”功能的核心。
*   **清理进度**: 如果您想让脚本重新转换所有文件（例如您更改了配置参数），只需**删除 `completed_list.log` 文件**即可。
*   **备份**: 强烈建议定期检查 `originalsFolder` 中的备份文件。在确认转码后的视频没有问题后，您可以安全地手动删除这些备份文件以释放磁盘空间。

## 免责声明
*   请务必先用几个不重要的测试文件来运行此脚本，以确保它的行为符合您的预期。
*   对于因使用此脚本可能造成的任何数据丢失，作者不承担任何责任。请自行做好重要文件的备份工作。
